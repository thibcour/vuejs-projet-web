(function(){"use strict";var e={4124:function(e,o,t){var a=t(5130),s=t(6768);const l=(0,s.Lk)("br",null,null,-1),n=(0,s.Lk)("br",null,null,-1);function r(e,o,t,a,r,i){const c=(0,s.g2)("AppNavbar"),d=(0,s.g2)("NotificationApp"),u=(0,s.g2)("router-view");return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.bF)(c),(0,s.bF)(d,{message:a.notification.message,type:a.notification.type},null,8,["message","type"]),l,n,(0,s.bF)(u)])}var i=t(4232);const c=e=>((0,s.Qi)("data-v-1f5c9874"),e=e(),(0,s.jt)(),e),d={class:"navbar navbar-expand-lg navbar-dark bg-dark fixed-top"},u={class:"container"},m=["src"],p=c((()=>(0,s.Lk)("a",{class:"navbar-brand",href:"#"},"Toobo",-1))),b=c((()=>(0,s.Lk)("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},[(0,s.Lk)("span",{class:"navbar-toggler-icon"})],-1))),k={class:"collapse navbar-collapse",id:"navbarSupportedContent"},v={class:"navbar-nav ms-auto mb-2 mb-lg-0"},g={class:"nav-item"},L={key:0,class:"nav-item"},h={key:1,class:"nav-item"},y={key:2,class:"nav-item"},f={class:"nav-link"},C={key:3,class:"nav-item"},w={key:4,class:"nav-item"};function A(e,o,t,a,l,n){const r=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)("nav",d,[(0,s.Lk)("div",u,[(0,s.Lk)("img",{src:l.logoUrl,alt:"Logo",class:"navbar-logo"},null,8,m),p,b,(0,s.Lk)("div",k,[(0,s.Lk)("ul",v,[(0,s.Lk)("li",g,[(0,s.bF)(r,{class:"nav-link active",to:"/"},{default:(0,s.k6)((()=>[(0,s.eW)("Home")])),_:1})]),a.isLoggedIn?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("li",L,[(0,s.bF)(r,{class:"nav-link",to:"/login"},{default:(0,s.k6)((()=>[(0,s.eW)("Login")])),_:1})])),a.isLoggedIn?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("li",h,[(0,s.bF)(r,{class:"nav-link",to:"/register"},{default:(0,s.k6)((()=>[(0,s.eW)("Register")])),_:1})])),a.isLoggedIn?((0,s.uX)(),(0,s.CE)("li",y,[(0,s.Lk)("span",f,(0,i.v_)(a.username),1)])):(0,s.Q3)("",!0),a.isLoggedIn?((0,s.uX)(),(0,s.CE)("li",C,[(0,s.Lk)("button",{class:"btn btn-link nav-link",onClick:o[0]||(o[0]=(...e)=>a.logout&&a.logout(...e))},"Logout")])):(0,s.Q3)("",!0),a.isAdmin?((0,s.uX)(),(0,s.CE)("li",w,[(0,s.bF)(r,{class:"nav-link",to:"/admin-dashboard"},{default:(0,s.k6)((()=>[(0,s.eW)("Dashboard")])),_:1})])):(0,s.Q3)("",!0)])])])])}t(4114);var E=t(782),P=t(1387);function M(e,o,t,a,l,n){const r=(0,s.g2)("AppMaps"),i=(0,s.g2)("MeteoApp"),c=(0,s.g2)("AppShop");return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.bF)(r),(0,s.bF)(i),(0,s.bF)(c)])}const U=e=>((0,s.Qi)("data-v-67618b6e"),e=e(),(0,s.jt)(),e),K={class:"map-container"},x={ref:"geocoderContainer",class:"geocoder-container flex-center"},R={ref:"map",class:"map"},I={ref:"geolocateContainer",class:"geolocate-container"},j=U((()=>(0,s.Lk)("div",{class:"geolocate-control custom-geolocate-button"},null,-1))),$=[j];function X(e,o,t,a,l,n){return(0,s.uX)(),(0,s.CE)("div",K,[(0,s.Lk)("div",x,null,512),(0,s.Lk)("div",R,null,512),(0,s.Lk)("div",I,$,512)])}var N=t(2693),F=t.n(N),T=t(8832),_=t.n(T),J={data(){return{searchQuery:"",mapboxAccessToken:"pk.eyJ1IjoidGlibzYxIiwiYSI6ImNsc2ttaWd5NDA0anEya3JuN2F4cWJheDIifQ.8Y7HydMrAImeaYD6xPm_vg"}},mounted(){F().accessToken=this.mapboxAccessToken,this.map=new(F().Map)({container:this.$refs.map,style:"mapbox://styles/mapbox/streets-v11",center:[2.3522,48.8566],zoom:11,attributionControl:!1});const e=new(F().GeolocateControl)({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0,showUserLocation:!0});if(this.map.addControl(e),window.innerWidth<=600){const e=new(_())({accessToken:F().accessToken,mapboxgl:F(),placeholder:"Entrez une adresse"}),o=e.onAdd(this.map);this.$refs.geocoderContainer.appendChild(o)}else{const e=new(_())({accessToken:F().accessToken,mapboxgl:F(),placeholder:"Entrez une adresse"});this.map.addControl(e,"top-left"),this.map.addControl(new(F().NavigationControl)({showCompass:!1}))}}},V=t(1241);const O=(0,V.A)(J,[["render",X],["__scopeId","data-v-67618b6e"]]);var Q=O;const S={class:"container"},D=(0,s.Lk)("div",{id:"openweathermap-widget-15"},null,-1),W=[D];function B(e,o,t,a,l,n){return(0,s.uX)(),(0,s.CE)("div",S,W)}var q={mounted(){window.myWidgetParam?window.myWidgetParam:window.myWidgetParam=[],window.myWidgetParam.push({id:15,cityid:"3003603",appid:"740ecf1f34a8de40fb609316e481a77e",units:"metric",containerid:"openweathermap-widget-15"}),function(){var e=document.createElement("script");e.async=!0,e.charset="utf-8",e.src="//openweathermap.org/themes/openweathermap/assets/vendor/owm/js/weather-widget-generator.js";var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(e,o)}()}};const z=(0,V.A)(q,[["render",B]]);var G=z;const Z=e=>((0,s.Qi)("data-v-1a86f6dc"),e=e(),(0,s.jt)(),e),H={key:0,class:"form-container"},Y=Z((()=>(0,s.Lk)("input",{type:"file",name:"image",class:"form-input"},null,-1))),ee=Z((()=>(0,s.Lk)("option",{disabled:"",value:""},"Veuillez sélectionner une catégorie",-1))),oe=Z((()=>(0,s.Lk)("option",null,"Jeans",-1))),te=Z((()=>(0,s.Lk)("option",null,"T-shirt",-1))),ae=Z((()=>(0,s.Lk)("option",null,"Chaussette",-1))),se=Z((()=>(0,s.Lk)("option",null,"Chaussure",-1))),le=[ee,oe,te,ae,se],ne=Z((()=>(0,s.Lk)("button",{type:"submit",class:"form-button"},"Ajouter le produit",-1))),re={ref:"productsSection",class:"products-container"},ie=["src","alt"],ce=["onClick"],de={key:1,class:"button-container"},ue={class:"category-buttons"},me={key:1,ref:"categoryButtons"},pe=["onClick"],be={class:"modal-dialog"},ke={class:"modal-content"},ve={class:"modal-header"},ge=Z((()=>(0,s.Lk)("h5",{class:"modal-title"},"Ajouter un produit",-1))),Le={class:"modal-body"},he={class:"mb-3"},ye=Z((()=>(0,s.Lk)("label",{class:"form-label"},"Nom du produit",-1))),fe={class:"mb-3"},Ce=Z((()=>(0,s.Lk)("label",{class:"form-label"},"Prix du produit",-1))),we={class:"mb-3"},Ae=Z((()=>(0,s.Lk)("label",{class:"form-label"},"Lien de la photo du produit",-1))),Ee={class:"mb-3"},Pe=Z((()=>(0,s.Lk)("label",{class:"form-label"},"Catégorie du produit",-1))),Me=["value"],Ue=Z((()=>(0,s.Lk)("option",{value:"new"},"Ajouter une nouvelle catégorie",-1))),Ke={class:"modal-footer"};function xe(e,o,t,l,n,r){return(0,s.uX)(),(0,s.CE)("div",null,[l.isAdmin?((0,s.uX)(),(0,s.CE)("div",H,[(0,s.Lk)("form",{onSubmit:o[3]||(o[3]=(0,a.D$)(((...e)=>l.addProduct&&l.addProduct(...e)),["prevent"])),class:"product-form"},[(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=e=>l.name=e),placeholder:"Nom du produit",class:"form-input"},null,512),[[a.Jo,l.name]]),Y,(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":o[1]||(o[1]=e=>l.price=e),placeholder:"Prix du produit",class:"form-input"},null,512),[[a.Jo,l.price]]),(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":o[2]||(o[2]=e=>l.category=e),class:"form-input"},le,512),[[a.u1,l.category]]),ne],32)])):(0,s.Q3)("",!0),(0,s.Lk)("div",re,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.products,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e.name,class:"product-item"},[(0,s.Lk)("img",{src:e.image,alt:e.name,class:"product-image",onLoad:o[4]||(o[4]=(...e)=>l.scrollToProduct&&l.scrollToProduct(...e))},null,40,ie),(0,s.Lk)("div",null,(0,i.v_)(e.name),1),(0,s.Lk)("div",null,(0,i.v_)(e.price),1),l.isLoggedIn&&l.selectedCategory?((0,s.uX)(),(0,s.CE)("button",{key:0,class:"add-to-collection-button",onClick:o=>l.addProductToMyCollection(e)},"Ajouter à ma collection",8,ce)):(0,s.Q3)("",!0)])))),128))],512),l.isLoggedIn?((0,s.uX)(),(0,s.CE)("div",de,[(0,s.Lk)("div",ue,[(0,s.Lk)("button",{class:"category-button",onClick:o[5]||(o[5]=(...e)=>r.handleButtonClick&&r.handleButtonClick(...e))},"Ma Collection"),(0,s.Lk)("button",{class:"category-button",onClick:o[6]||(o[6]=e=>{l.showCategories=!l.showCategories,l.showMyCollection=!1,l.scrollToCategories(),l.fetchProducts(""),l.selectedCategory=null})},"Collection du Site")]),l.showMyCollection?((0,s.uX)(),(0,s.CE)("button",{key:0,class:"category-button",onClick:o[7]||(o[7]=e=>n.showAddProductModal=!0)}," Ajouter un produit ")):(0,s.Q3)("",!0),l.showCategories?((0,s.uX)(),(0,s.CE)("div",me,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.filteredCategories,(e=>((0,s.uX)(),(0,s.CE)("button",{key:e,class:"category-button",onClick:o=>{l.fetchProducts(e),l.selectedCategory=e}},(0,i.v_)(e),9,pe)))),128))],512)):(0,s.Q3)("",!0)])):(0,s.Q3)("",!0),n.showAddProductModal?((0,s.uX)(),(0,s.CE)("div",{key:2,class:(0,i.C4)(["modal",{"show d-block":n.showAddProductModal}]),tabindex:"-1"},[(0,s.Lk)("div",be,[(0,s.Lk)("div",ke,[(0,s.Lk)("div",ve,[ge,(0,s.Lk)("button",{type:"button",class:"btn-close",onClick:o[8]||(o[8]=e=>n.showAddProductModal=!1)})]),(0,s.Lk)("div",Le,[(0,s.Lk)("div",he,[ye,(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":o[9]||(o[9]=e=>n.newProduct.name=e),class:"form-control"},null,512),[[a.Jo,n.newProduct.name]])]),(0,s.Lk)("div",fe,[Ce,(0,s.bo)((0,s.Lk)("input",{type:"number","onUpdate:modelValue":o[10]||(o[10]=e=>n.newProduct.price=e),class:"form-control"},null,512),[[a.Jo,n.newProduct.price]])]),(0,s.Lk)("div",we,[Ae,(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":o[11]||(o[11]=e=>n.newProduct.image=e),class:"form-control"},null,512),[[a.Jo,n.newProduct.image]])]),(0,s.Lk)("div",Ee,[Pe,(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":o[12]||(o[12]=e=>n.newProduct.category=e),class:"form-control"},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.categories,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e,value:e},(0,i.v_)(e),9,Me)))),128)),Ue],512),[[a.u1,n.newProduct.category]])])]),(0,s.Lk)("div",Ke,[(0,s.Lk)("button",{type:"button",class:"btn btn-secondary",onClick:o[13]||(o[13]=e=>n.showAddProductModal=!1)},"Fermer"),(0,s.Lk)("button",{type:"button",class:"btn btn-primary",onClick:o[14]||(o[14]=(...e)=>l.addProduct&&l.addProduct(...e))},"Ajouter le produit")])])])],2)):(0,s.Q3)("",!0)])}var Re=t(144),Ie=t(4161),je=t(7844),$e={data(){return{showAddProductModal:!1,newProduct:{name:"",price:"",image:"",category:""}}},methods:{handleButtonClick(){this.showMyCollection=!this.showMyCollection,this.showCategories=!1,this.showMyCollection&&this.fetchMyCollection()}},setup(){const e=(0,Re.KR)(""),o=(0,Re.KR)(""),t=(0,Re.KR)(""),a=(0,Re.KR)(["Jeans","T-shirt","Chaussette","Chaussure"]),l=(0,Re.KR)([]),n=(0,Re.KR)(""),r=(0,E.Pj)(),i=(0,s.EW)((()=>r.state.admin)),c=(0,s.EW)((()=>r.state.isLoggedIn)),d=(0,Re.KR)(!1),u=(0,Re.KR)(!1),m=(0,Re.KR)(null),p=(0,s.EW)((()=>r.state.user?r.state.user.uid:null)),b=(0,Re.KR)(null),k=()=>{(0,s.dY)((()=>{m.value&&m.value.scrollIntoView({behavior:"smooth"})}))},v=async(e,o)=>{const t=(0,je.c7)(),a=(0,je.KR)(t,`users/${o}/products/${e.name}`),s=(0,je.bp)(a,e);return new Promise(((e,o)=>{s.on("state_changed",(e=>{const o=e.bytesTransferred/e.totalBytes*100;console.log("Upload is "+o+"% done")}),(e=>{o(e)}),(()=>{(0,je.qk)(s.snapshot.ref).then((o=>{e(o)}))}))}))},g=async a=>{a.preventDefault();const s=a.target.elements.image.files[0],l=await v(s,p),n=(0,Ie.C3)(),r=(0,Ie.KR)(n,`users/${p.value}/products/${t.value}/${e.value}`);(0,Ie.hZ)(r,{name:e.value,image:l,price:o.value}),e.value="",o.value="",t.value=""},L=async e=>{const o=(0,Ie.C3)(),t=(0,Ie.KR)(o,`products/${e}`);(0,Ie.Zy)(t,(e=>{l.value=e.val()}))},h=()=>{(0,s.dY)((()=>{const e=document.querySelector(".product-image");e&&e.scrollIntoView({behavior:"smooth"})}))};(0,s.wB)(l,(()=>{(0,s.dY)((()=>{const e=document.querySelector(".product-image");e&&e.scrollIntoView({behavior:"smooth"})}))}));const y=(0,s.EW)((()=>a.value)),f=async()=>{const e=(0,Ie.C3)(),o=(0,Ie.KR)(e,"myCollection");(0,Ie.Zy)(o,(e=>{l.value=e.val()}))},C=async()=>{const e=(0,Ie.C3)(),o=(0,Ie.KR)(e,"siteCollection");(0,Ie.Zy)(o,(e=>{l.value=e.val()}))},w=async e=>{const o=(0,Ie.C3)(),t=(0,Ie.KR)(o,`users/${p.value}/myCollection/${e.name}`);(0,Ie.hZ)(t,e)};return{fetchSiteCollection:C,isAdmin:i,name:e,price:o,category:t,categories:a,products:l,addProduct:g,fetchProducts:L,fetchMyCollection:f,addProductToMyCollection:w,scrollToProduct:h,message:n,filteredCategories:y,isLoggedIn:c,showCategories:d,showMyCollection:u,categoryButtons:m,scrollToCategories:k,selectedCategory:b}}};const Xe=(0,V.A)($e,[["render",xe],["__scopeId","data-v-1a86f6dc"]]);var Ne=Xe,Fe={name:"HomePage",components:{AppMaps:Q,MeteoApp:G,AppShop:Ne},setup(){const e=(0,E.Pj)(),o=(0,s.EW)((()=>e.state.admin)),t=(0,s.EW)((()=>e.state.isLoggedIn));return{isAdmin:o,isLoggedIn:t}}};const Te=(0,V.A)(Fe,[["render",M]]);var _e=Te;const Je={class:"container mt-5"},Ve={class:"row justify-content-center"},Oe={class:"col-md-12"},Qe={class:"card"},Se=(0,s.Lk)("div",{class:"card-header"},"Login",-1),De={class:"card-body"},We={class:"mb-3"},Be=(0,s.Lk)("label",{class:"form-label"},"Email",-1),qe={class:"mb-3"},ze=(0,s.Lk)("label",{class:"form-label"},"Password",-1),Ge=(0,s.Lk)("button",{type:"submit",class:"btn btn-primary"},"Login",-1);function Ze(e,o,t,l,n,r){return(0,s.uX)(),(0,s.CE)("div",Je,[(0,s.Lk)("div",Ve,[(0,s.Lk)("div",Oe,[(0,s.Lk)("div",Qe,[Se,(0,s.Lk)("div",De,[(0,s.Lk)("form",{onSubmit:o[2]||(o[2]=(0,a.D$)(((...e)=>l.login&&l.login(...e)),["prevent"]))},[(0,s.Lk)("div",We,[Be,(0,s.bo)((0,s.Lk)("input",{type:"email","onUpdate:modelValue":o[0]||(o[0]=e=>l.email=e),class:"form-control",placeholder:"Email",required:""},null,512),[[a.Jo,l.email]])]),(0,s.Lk)("div",qe,[ze,(0,s.bo)((0,s.Lk)("input",{type:"password","onUpdate:modelValue":o[1]||(o[1]=e=>l.password=e),class:"form-control",placeholder:"Password",required:""},null,512),[[a.Jo,l.password]])]),Ge],32)])])])])])}var He=t(5600),Ye={setup(){const e=(0,E.Pj)(),o=(0,Re.KR)(""),t=(0,Re.KR)(""),a=async()=>{const a=(0,He.xI)();try{const s=await(0,He.x9)(a,t.value,o.value),l=s.user,n=(0,Ie.C3)(),r=(0,Ie.KR)(n,`users/${l.uid}`),i=await(0,Ie.Jt)(r);i.exists()&&(l.username=i.val().username);const c=await e.dispatch("login",l);c?Ga.push("/admin-dashboard"):Ga.push("/"),e.dispatch("showNotification",{message:"Connexion réussie",type:"success"}),t.value="",o.value=""}catch(s){console.error(s.code),console.error(s.message),e.dispatch("showNotification",{message:s.message,type:"error"})}};return{email:t,password:o,login:a}}};const eo=(0,V.A)(Ye,[["render",Ze]]);var oo=eo;const to={class:"container mt-5"},ao={class:"row justify-content-center"},so={class:"col-md-12"},lo={class:"card"},no=(0,s.Lk)("div",{class:"card-header"},"Inscription",-1),ro={class:"card-body"},io={class:"mb-3"},co=(0,s.Lk)("label",{class:"form-label"},"Nom d'utilisateur",-1),uo={class:"mb-3"},mo=(0,s.Lk)("label",{class:"form-label"},"Email",-1),po={class:"mb-3"},bo=(0,s.Lk)("label",{class:"form-label"},"Mot de passe",-1),ko=(0,s.Lk)("button",{type:"submit",class:"btn btn-primary"},"Inscription",-1),vo=(0,s.Lk)("br",null,null,-1);function go(e,o,t,l,n,r){return(0,s.uX)(),(0,s.CE)("div",to,[(0,s.Lk)("div",ao,[(0,s.Lk)("div",so,[(0,s.Lk)("div",lo,[no,(0,s.Lk)("div",ro,[(0,s.Lk)("form",{onSubmit:o[3]||(o[3]=(0,a.D$)(((...e)=>l.register&&l.register(...e)),["prevent"]))},[(0,s.Lk)("div",io,[co,(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=e=>l.username=e),class:"form-control",placeholder:"Nom d'utilisateur",required:""},null,512),[[a.Jo,l.username]])]),(0,s.Lk)("div",uo,[mo,(0,s.bo)((0,s.Lk)("input",{type:"email","onUpdate:modelValue":o[1]||(o[1]=e=>l.email=e),class:"form-control",placeholder:"Email",required:""},null,512),[[a.Jo,l.email]])]),(0,s.Lk)("div",po,[bo,(0,s.bo)((0,s.Lk)("input",{type:"password","onUpdate:modelValue":o[2]||(o[2]=e=>l.password=e),class:"form-control",placeholder:"Mot de passe",required:""},null,512),[[a.Jo,l.password]])]),ko],32),vo])])])])])}var Lo={setup(){const e=(0,E.Pj)(),o=(0,Re.KR)(""),t=(0,Re.KR)(""),a=(0,Re.KR)(""),s=async()=>{const s=(0,He.xI)();(0,He.eG)(s);const l=/^[\w-]+(\.[\w-]+)*@([\w-]+\.)+[a-zA-Z]{2,7}$/;if(l.test(a.value))if(t.value.length<6)e.dispatch("showNotification",{message:"Le mot de passe doit comporter au moins 6 caractères",type:"error"});else try{const l=await(0,He.eJ)(s,a.value,t.value),n=l.user,r=(0,Ie.C3)(),i=(0,Ie.KR)(r,`users/${n.uid}`);await(0,Ie.hZ)(i,{admin:!1,email:n.email,username:o.value});const c=await(0,Ie.Jt)(i);c.exists()&&(n.username=c.val().username,n.admin=c.val().admin);const d=await e.dispatch("login",n);d?Ga.push("/admin-dashboard"):Ga.push("/"),e.dispatch("showNotification",{message:"Inscription réussie",type:"success"}),o.value="",t.value="",a.value=""}catch(n){console.error(n.code),console.error(n.message),e.dispatch("showNotification",{message:n.message,type:"error"})}else e.dispatch("showNotification",{message:"L'email n'est pas valide",type:"error"})};return{username:o,password:t,email:a,register:s}}};const ho=(0,V.A)(Lo,[["render",go]]);var yo=ho,fo=t(4912);const Co=e=>((0,s.Qi)("data-v-2900739f"),e=e(),(0,s.jt)(),e),wo={class:"not-found-container"},Ao=Co((()=>(0,s.Lk)("img",{src:fo,alt:"Logo",class:"logo"},null,-1))),Eo=Co((()=>(0,s.Lk)("h1",null,"404 Not Found",-1))),Po=Co((()=>(0,s.Lk)("p",null,"La page que vous recherchez n'existe pas.",-1))),Mo=[Ao,Eo,Po];function Uo(e,o,t,a,l,n){return(0,s.uX)(),(0,s.CE)("div",wo,Mo)}var Ko={name:"NotFound"};const xo=(0,V.A)(Ko,[["render",Uo],["__scopeId","data-v-2900739f"]]);var Ro=xo;const Io=e=>((0,s.Qi)("data-v-293a70fb"),e=e(),(0,s.jt)(),e),jo={class:"dashboard"},$o=Io((()=>(0,s.Lk)("div",{class:"icon"},[(0,s.Lk)("i",{class:"fas fa-users"})],-1))),Xo=Io((()=>(0,s.Lk)("div",{class:"title"},"Gestion des utilisateurs",-1))),No=[$o,Xo],Fo=Io((()=>(0,s.Lk)("div",{class:"icon"},[(0,s.Lk)("i",{class:"fas fa-box-open"})],-1))),To=Io((()=>(0,s.Lk)("div",{class:"title"},"Gestion des produits",-1))),_o=[Fo,To];function Jo(e,o,t,a,l,n){return(0,s.uX)(),(0,s.CE)("div",jo,[(0,s.Lk)("div",{class:"card",onClick:o[0]||(o[0]=o=>e.$router.push("/user-management"))},No),(0,s.Lk)("div",{class:"card",onClick:o[1]||(o[1]=o=>e.$router.push("/product-management"))},_o)])}var Vo={};const Oo=(0,V.A)(Vo,[["render",Jo],["__scopeId","data-v-293a70fb"]]);var Qo=Oo;async function So(e){const o=(0,Ie.C3)(),t=(0,Ie.KR)(o,`users/${e}`),a=await(0,Ie.Jt)(t),s=a.val();if(s)return!0===s.admin;throw new Error("User does not exist")}var Do=(0,E.y$)({state:{isLoading:!0,isLoggedIn:!1,user:null,admin:!1,users:{},notification:{message:"",type:"info"}},mutations:{setLoading(e,o){e.isLoading=o},setUser(e,o){e.user=o,e.isLoggedIn=!!o,e.admin=!!o&&o.admin,localStorage.setItem("authToken",o.authToken)},setNotification(e,o){e.notification=o}},actions:{async init({dispatch:e}){return new Promise(((o,t)=>{const a=(0,He.hg)((0,He.xI)(),(t=>{t&&e("checkAdminStatus"),a(),o()}),t)}))},async login({commit:e},o){const t=await So(o.uid);return e("setUser",{...o,admin:t}),t},logout({commit:e}){const o=(0,He.xI)();(0,He.CI)(o).then((()=>{e("setUser",null),localStorage.removeItem("authToken"),localStorage.removeItem("user")})).catch((e=>{console.error(e)}))},showNotification({commit:e},o){e("setNotification",o),setTimeout((()=>{e("setNotification",{message:"",type:"info"})}),3e3)},async checkAdminStatus({commit:e}){const o=(0,He.xI)(),t=o.currentUser;if(t)try{const o=await So(t.uid),a=(0,Ie.C3)(),s=(0,Ie.KR)(a,`users/${t.uid}`),l=await(0,Ie.Jt)(s);return l.exists()&&(t.username=l.val().username),e("setUser",{...t,admin:o}),Promise.resolve()}catch(a){return Promise.reject(a)}else{const o=JSON.parse(localStorage.getItem("user"));o&&e("setUser",o)}}}});const Wo=e=>((0,s.Qi)("data-v-63a4af42"),e=e(),(0,s.jt)(),e),Bo={class:"mt-5"},qo={class:"col-6"},zo={class:"mb-3"},Go=Wo((()=>(0,s.Lk)("label",{class:"form-label"},"Gestion des utilisateurs",-1))),Zo=Wo((()=>(0,s.Lk)("hr",null,null,-1))),Ho=Wo((()=>(0,s.Lk)("div",null,null,-1))),Yo={class:"table-responsive"},et={class:"table table-striped"},ot=Wo((()=>(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,"Nom d'utilisateur"),(0,s.Lk)("th",null,"Email"),(0,s.Lk)("th",null,"UID"),(0,s.Lk)("th",null,"Admin"),(0,s.Lk)("th",null,"Actions")])],-1))),tt={key:0,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-check-circle-fill svg-icon",viewBox:"0 0 16 16"},at=Wo((()=>(0,s.Lk)("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323A.75.75 0 0 0 4.616 8.03l2.363 2.394a.75.75 0 0 0 1.06 0l4.886-4.976a.75.75 0 0 0-.025-1.065z"},null,-1))),st=[at],lt={key:1,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-x-circle-fill svg-icon",viewBox:"0 0 16 16"},nt=Wo((()=>(0,s.Lk)("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.293-2.707a1 1 0 0 0-1.414-1.414L8 6.586 5.707 4.293a1 1 0 0 0-1.414 1.414L6.586 8l-2.293 2.293a1 1 0 0 0 1.414 1.414L8 9.414l2.293 2.293a1 1 0 0 0 1.414-1.414L9.414 8l2.293-2.293z"},null,-1))),rt=[nt],it=["onClick"],ct=["onClick"],dt=["onClick"],ut={class:"modal-dialog"},mt={class:"modal-content"},pt={class:"modal-header"},bt=Wo((()=>(0,s.Lk)("h5",{class:"modal-title"},"Modifier l'utilisateur",-1))),kt={class:"modal-body"},vt={class:"mb-3"},gt=Wo((()=>(0,s.Lk)("label",{class:"form-label"},"Nom d'utilisateur",-1))),Lt={class:"mb-3"},ht=Wo((()=>(0,s.Lk)("label",{class:"form-label"},"Admin",-1))),yt=Wo((()=>(0,s.Lk)("option",{value:!0},"True",-1))),ft=Wo((()=>(0,s.Lk)("option",{value:!1},"False",-1))),Ct=[yt,ft],wt={class:"modal-footer"},At={class:"modal-dialog"},Et={class:"modal-content"},Pt={class:"modal-header"},Mt=Wo((()=>(0,s.Lk)("h5",{class:"modal-title"},"Ajouter un utilisateur",-1))),Ut={class:"modal-body"},Kt={class:"mb-3"},xt=Wo((()=>(0,s.Lk)("label",{class:"form-label"},"Nom d'utilisateur",-1))),Rt={class:"mb-3"},It=Wo((()=>(0,s.Lk)("label",{class:"form-label"},"Mot de passe",-1))),jt={class:"mb-3"},$t=Wo((()=>(0,s.Lk)("label",{class:"form-label"},"Email",-1))),Xt={class:"mb-3"},Nt=Wo((()=>(0,s.Lk)("label",{class:"form-label"},"Admin",-1))),Ft=Wo((()=>(0,s.Lk)("option",{value:!0},"True",-1))),Tt=Wo((()=>(0,s.Lk)("option",{value:!1},"False",-1))),_t=[Ft,Tt],Jt={key:0,class:"alert alert-danger"},Vt={class:"modal-footer"};function Ot(e,o,t,l,n,r){return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("button",{class:"btn btn-secondary float-right go-back-button",onClick:o[0]||(o[0]=(...e)=>r.goBack&&r.goBack(...e))},"Retour"),(0,s.Lk)("div",Bo,[(0,s.Lk)("div",qo,[(0,s.Lk)("div",zo,[Go,Zo,(0,s.Lk)("button",{class:"btn btn-success mb-3",onClick:o[1]||(o[1]=(...e)=>l.openAddUserModal&&l.openAddUserModal(...e))},"Ajouter un utilisateur"),Ho])]),(0,s.Lk)("div",Yo,[(0,s.Lk)("table",et,[ot,(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.users,((e,o)=>((0,s.uX)(),(0,s.CE)("tr",{key:o},[(0,s.Lk)("td",null,(0,i.v_)(e.username),1),(0,s.Lk)("td",null,(0,i.v_)(e.email),1),(0,s.Lk)("td",null,(0,i.v_)(o),1),(0,s.Lk)("td",null,[e.admin?((0,s.uX)(),(0,s.CE)("svg",tt,st)):((0,s.uX)(),(0,s.CE)("svg",lt,rt))]),(0,s.Lk)("td",null,[(0,s.Lk)("button",{class:"btn btn-primary me-2",onClick:t=>l.openEditUserModal(e,o)},"Modifier",8,it),(0,s.Lk)("button",{class:"btn btn-danger me-2",onClick:e=>l.deleteUser(o)},"Supprimer",8,ct),(0,s.Lk)("button",{class:"btn btn-secondary me-2",onClick:e=>l.toggleAdmin(o)},"Changer le statut d'admin",8,dt)])])))),128))])])]),l.isEditUserModalOpen?((0,s.uX)(),(0,s.CE)("div",{key:0,class:(0,i.C4)(["modal",{"show d-block":l.isEditUserModalOpen}]),tabindex:"-1"},[(0,s.Lk)("div",ut,[(0,s.Lk)("div",mt,[(0,s.Lk)("div",pt,[bt,(0,s.Lk)("button",{type:"button",class:"btn-close",onClick:o[2]||(o[2]=(...e)=>l.closeEditUserModal&&l.closeEditUserModal(...e))})]),(0,s.Lk)("div",kt,[(0,s.Lk)("div",vt,[gt,(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":o[3]||(o[3]=e=>l.editedUser.username=e),class:"form-control"},null,512),[[a.Jo,l.editedUser.username]])]),(0,s.Lk)("div",Lt,[ht,(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":o[4]||(o[4]=e=>l.editedUser.admin=e),class:"form-control"},Ct,512),[[a.u1,l.editedUser.admin]])])]),(0,s.Lk)("div",wt,[(0,s.Lk)("button",{type:"button",class:"btn btn-secondary",onClick:o[5]||(o[5]=(...e)=>l.closeEditUserModal&&l.closeEditUserModal(...e))},"Fermer"),(0,s.Lk)("button",{type:"button",class:"btn btn-primary",onClick:o[6]||(o[6]=e=>l.editUser(l.editedUser,l.editedUser.uid))},"Enregistrer les modifications")])])])],2)):(0,s.Q3)("",!0),l.isAddUserModalOpen?((0,s.uX)(),(0,s.CE)("div",{key:1,class:(0,i.C4)(["modal",{"show d-block":l.isAddUserModalOpen}]),tabindex:"-1"},[(0,s.Lk)("div",At,[(0,s.Lk)("div",Et,[(0,s.Lk)("div",Pt,[Mt,(0,s.Lk)("button",{type:"button",class:"btn-close",onClick:o[7]||(o[7]=(...e)=>l.closeAddUserModal&&l.closeAddUserModal(...e))})]),(0,s.Lk)("div",Ut,[(0,s.Lk)("div",Kt,[xt,(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":o[8]||(o[8]=e=>l.newUser.username=e),class:"form-control"},null,512),[[a.Jo,l.newUser.username]])]),(0,s.Lk)("div",Rt,[It,(0,s.bo)((0,s.Lk)("input",{type:"password","onUpdate:modelValue":o[9]||(o[9]=e=>l.newUser.password=e),class:"form-control"},null,512),[[a.Jo,l.newUser.password]])]),(0,s.Lk)("div",jt,[$t,(0,s.bo)((0,s.Lk)("input",{type:"email","onUpdate:modelValue":o[10]||(o[10]=e=>l.newUser.email=e),class:"form-control"},null,512),[[a.Jo,l.newUser.email]])]),(0,s.Lk)("div",Xt,[Nt,(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":o[11]||(o[11]=e=>l.newUser.admin=e),class:"form-control"},_t,512),[[a.u1,l.newUser.admin]])]),l.newUser.errorMessage?((0,s.uX)(),(0,s.CE)("div",Jt,(0,i.v_)(l.newUser.errorMessage),1)):(0,s.Q3)("",!0)]),(0,s.Lk)("div",Vt,[(0,s.Lk)("button",{type:"button",class:"btn btn-secondary",onClick:o[12]||(o[12]=(...e)=>l.closeAddUserModal&&l.closeAddUserModal(...e))},"Fermer"),(0,s.Lk)("button",{type:"button",class:"btn btn-primary",onClick:o[13]||(o[13]=(...e)=>l.addUser&&l.addUser(...e))},"Ajouter l'utilisateur")])])])],2)):(0,s.Q3)("",!0)])],64)}var Qt={methods:{goBack(){this.$router.push("/admin-dashboard")}},setup(){const e=(0,Ie.C3)(),o=(0,Re.KR)({}),t=(0,Re.KR)(!1),a=(0,Re.KR)({}),l=(0,Re.KR)(!1),n=(0,Re.KR)({});(0,s.sV)((async()=>{const t=(0,Ie.KR)(e,"users");(0,Ie.Zy)(t,(e=>{o.value=e.val()}))}));const r=async o=>{const t=(0,Ie.KR)(e,`users/${o}`),a=await(0,Ie.Jt)(t),s=a.val();await(0,Ie.yo)(t,{admin:!s.admin})},i=(e,o)=>{a.value={...e,uid:o},t.value=!0,console.log(a.value)},c=()=>{t.value=!1},d=async(o,t)=>{const a=(0,Ie.KR)(e,`users/${t}`);await(0,Ie.yo)(a,{admin:o.admin,username:o.username}),c()},u=async e=>{const o=(0,He.xI)(),t=o.currentUser;if(t&&t.uid===e){await(0,He.hG)(t).catch((o=>{console.error(`Failed to delete user: ${e}`,o)}));const o=(0,Ie.C3)(),a=(0,Ie.KR)(o,`users/${e}`);await(0,Ie.TF)(a).catch((o=>{console.error(`Failed to delete user from database: ${e}`,o)}))}else console.error("User does not exist or is not currently signed in:",e)},m=()=>{n.value={username:"",password:"",admin:!1},l.value=!0},p=()=>{l.value=!1},b=async()=>{const e=(0,He.xI)(),{username:o,password:t,email:a,admin:s}=n.value;try{const l=await(0,He.eJ)(e,a,t),n=l.user;await(0,He.r7)(n,{displayName:o});const r=(0,Ie.C3)(),i=(0,Ie.KR)(r,`users/${n.uid}`);await(0,Ie.yo)(i,{admin:s,email:a,username:o}),p(),Do.dispatch("showNotification",{message:"Utilisateur ajouté avec succès",type:"success"})}catch(l){console.error(`Failed to create user: ${o}`,l.code,l.message),Do.dispatch("showNotification",{message:`Échec de l'ajout de l'utilisateur : ${l.message}`,type:"error"})}};return{users:o,toggleAdmin:r,isEditUserModalOpen:t,editedUser:a,openEditUserModal:i,closeEditUserModal:c,editUser:d,deleteUser:u,isAddUserModalOpen:l,newUser:n,openAddUserModal:m,closeAddUserModal:p,addUser:b}}};const St=(0,V.A)(Qt,[["render",Ot],["__scopeId","data-v-63a4af42"]]);var Dt=St;const Wt=e=>((0,s.Qi)("data-v-31679dfc"),e=e(),(0,s.jt)(),e),Bt={class:"mt-5"},qt={class:"col-6"},zt={class:"mb-3"},Gt=Wt((()=>(0,s.Lk)("label",{class:"form-label"},"Gestion des Produits",-1))),Zt=["onClick"],Ht={class:"mb-3"},Yt={class:"table-responsive"},ea={class:"table table-striped"},oa=Wt((()=>(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,"Image"),(0,s.Lk)("th",null,"Nom du produit"),(0,s.Lk)("th",null,"Prix"),(0,s.Lk)("th",null,"Actions")])],-1))),ta=["src"],aa=["onClick"],sa=["onClick"],la={class:"modal-dialog"},na={class:"modal-content"},ra={class:"modal-header"},ia=Wt((()=>(0,s.Lk)("h5",{class:"modal-title"},"Modifier le produit",-1))),ca={class:"modal-body"},da={class:"mb-3"},ua=Wt((()=>(0,s.Lk)("label",{class:"form-label"},"Nom du produit",-1))),ma={class:"mb-3"},pa=Wt((()=>(0,s.Lk)("label",{class:"form-label"},"Prix du produit",-1))),ba={class:"mb-3"},ka=Wt((()=>(0,s.Lk)("label",{class:"form-label"},"Lien de la photo du produit",-1))),va={class:"modal-footer"},ga={class:"modal-dialog"},La={class:"modal-content"},ha={class:"modal-header"},ya=Wt((()=>(0,s.Lk)("h5",{class:"modal-title"},"Ajouter un produit",-1))),fa={class:"modal-body"},Ca={class:"mb-3"},wa=Wt((()=>(0,s.Lk)("label",{class:"form-label"},"Nom du produit",-1))),Aa={class:"mb-3"},Ea=Wt((()=>(0,s.Lk)("label",{class:"form-label"},"Prix du produit",-1))),Pa={class:"mb-3"},Ma=Wt((()=>(0,s.Lk)("label",{class:"form-label"},"Lien de la photo du produit",-1))),Ua={class:"mb-3"},Ka=Wt((()=>(0,s.Lk)("label",{class:"form-label"},"Catégorie du produit",-1))),xa=["value"],Ra=Wt((()=>(0,s.Lk)("option",{value:"new"},"Ajouter une nouvelle catégorie",-1))),Ia={key:0,class:"mb-3"},ja=Wt((()=>(0,s.Lk)("label",{class:"form-label"},"Nom de la nouvelle catégorie",-1))),$a={class:"modal-footer"},Xa={class:"modal-dialog"},Na={class:"modal-content"},Fa={class:"modal-header"},Ta=Wt((()=>(0,s.Lk)("h5",{class:"modal-title"},"Supprimer une catégorie",-1))),_a={class:"modal-body"},Ja={class:"mb-3"},Va=Wt((()=>(0,s.Lk)("label",{class:"form-label"},"Catégorie à supprimer",-1))),Oa=["value"],Qa={class:"modal-footer"};function Sa(e,o,t,l,n,r){return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("button",{class:"btn btn-secondary float-right go-back-button",onClick:o[0]||(o[0]=(...e)=>r.goBack&&r.goBack(...e))},"Retour"),(0,s.Lk)("div",Bt,[(0,s.Lk)("div",qt,[(0,s.Lk)("div",zt,[Gt,(0,s.Lk)("div",null,[(0,s.Lk)("button",{class:"btn btn-outline-primary me-2",onClick:o[1]||(o[1]=e=>l.selectedCategory="")},"Tous les produits"),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.categories,(e=>((0,s.uX)(),(0,s.CE)("button",{key:e,class:"btn btn-outline-secondary me-2",onClick:o=>l.selectedCategory=e},(0,i.v_)(e),9,Zt)))),128))])]),(0,s.Lk)("div",Ht,[(0,s.Lk)("button",{class:"btn btn-primary me-2",onClick:o[2]||(o[2]=(...e)=>l.openAddProductModal&&l.openAddProductModal(...e))},"Ajouter un produit"),(0,s.Lk)("button",{class:"btn btn-danger me-2",onClick:o[3]||(o[3]=(...e)=>l.openDeleteCategoryModal&&l.openDeleteCategoryModal(...e))},"Supprimer une catégorie")])]),(0,s.Lk)("div",Yt,[(0,s.Lk)("table",ea,[oa,(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.filteredProducts,(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.name},[(0,s.Lk)("td",null,[(0,s.Lk)("img",{src:e.image,alt:"Product image",class:"product-image"},null,8,ta)]),(0,s.Lk)("td",null,(0,i.v_)(e.name),1),(0,s.Lk)("td",null,(0,i.v_)(e.price),1),(0,s.Lk)("td",null,[(0,s.Lk)("button",{class:"btn btn-primary me-2",onClick:o=>l.openEditModal(e)},"Modifier",8,aa),(0,s.Lk)("button",{class:"btn btn-danger me-2",onClick:o=>l.deleteProduct(e,e.category)},"Supprimer",8,sa)])])))),128))])])]),l.isEditModalOpen?((0,s.uX)(),(0,s.CE)("div",{key:0,class:(0,i.C4)(["modal",{"show d-block":l.isEditModalOpen}]),tabindex:"-1"},[(0,s.Lk)("div",la,[(0,s.Lk)("div",na,[(0,s.Lk)("div",ra,[ia,(0,s.Lk)("button",{type:"button",class:"btn-close",onClick:o[4]||(o[4]=(...e)=>l.closeEditModal&&l.closeEditModal(...e))})]),(0,s.Lk)("div",ca,[(0,s.Lk)("div",da,[ua,(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":o[5]||(o[5]=e=>l.editedProduct.name=e),class:"form-control"},null,512),[[a.Jo,l.editedProduct.name]])]),(0,s.Lk)("div",ma,[pa,(0,s.bo)((0,s.Lk)("input",{type:"number","onUpdate:modelValue":o[6]||(o[6]=e=>l.editedProduct.price=e),class:"form-control"},null,512),[[a.Jo,l.editedProduct.price]])]),(0,s.Lk)("div",ba,[ka,(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":o[7]||(o[7]=e=>l.editedProduct.image=e),class:"form-control"},null,512),[[a.Jo,l.editedProduct.image]])])]),(0,s.Lk)("div",va,[(0,s.Lk)("button",{type:"button",class:"btn btn-secondary",onClick:o[8]||(o[8]=(...e)=>l.closeEditModal&&l.closeEditModal(...e))},"Fermer"),(0,s.Lk)("button",{type:"button",class:"btn btn-primary",onClick:o[9]||(o[9]=(...e)=>l.editProduct&&l.editProduct(...e))},"Enregistrer les modifications")])])])],2)):(0,s.Q3)("",!0),l.isAddProductModalOpen?((0,s.uX)(),(0,s.CE)("div",{key:1,class:(0,i.C4)(["modal",{"show d-block":l.isAddProductModalOpen}]),tabindex:"-1"},[(0,s.Lk)("div",ga,[(0,s.Lk)("div",La,[(0,s.Lk)("div",ha,[ya,(0,s.Lk)("button",{type:"button",class:"btn-close",onClick:o[10]||(o[10]=(...e)=>l.closeAddProductModal&&l.closeAddProductModal(...e))})]),(0,s.Lk)("div",fa,[(0,s.Lk)("div",Ca,[wa,(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":o[11]||(o[11]=e=>l.newProduct.name=e),class:"form-control"},null,512),[[a.Jo,l.newProduct.name]])]),(0,s.Lk)("div",Aa,[Ea,(0,s.bo)((0,s.Lk)("input",{type:"number","onUpdate:modelValue":o[12]||(o[12]=e=>l.newProduct.price=e),class:"form-control"},null,512),[[a.Jo,l.newProduct.price]])]),(0,s.Lk)("div",Pa,[Ma,(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":o[13]||(o[13]=e=>l.newProduct.image=e),class:"form-control"},null,512),[[a.Jo,l.newProduct.image]])]),(0,s.Lk)("div",Ua,[Ka,(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":o[14]||(o[14]=e=>l.newProduct.category=e),class:"form-control",onChange:o[15]||(o[15]=(...e)=>l.handleCategoryChange&&l.handleCategoryChange(...e))},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.categories,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e,value:e},(0,i.v_)(e),9,xa)))),128)),Ra],544),[[a.u1,l.newProduct.category]])]),l.isNewCategory?((0,s.uX)(),(0,s.CE)("div",Ia,[ja,(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":o[16]||(o[16]=e=>l.newCategory=e),class:"form-control"},null,512),[[a.Jo,l.newCategory]])])):(0,s.Q3)("",!0)]),(0,s.Lk)("div",$a,[(0,s.Lk)("button",{type:"button",class:"btn btn-secondary",onClick:o[17]||(o[17]=(...e)=>l.closeAddProductModal&&l.closeAddProductModal(...e))},"Fermer"),(0,s.Lk)("button",{type:"button",class:"btn btn-primary",onClick:o[18]||(o[18]=(...e)=>l.addProduct&&l.addProduct(...e))},"Ajouter le produit")])])])],2)):(0,s.Q3)("",!0),l.isDeleteCategoryModalOpen?((0,s.uX)(),(0,s.CE)("div",{key:2,class:(0,i.C4)(["modal",{"show d-block":l.isDeleteCategoryModalOpen}]),tabindex:"-1"},[(0,s.Lk)("div",Xa,[(0,s.Lk)("div",Na,[(0,s.Lk)("div",Fa,[Ta,(0,s.Lk)("button",{type:"button",class:"btn-close",onClick:o[19]||(o[19]=(...e)=>l.closeDeleteCategoryModal&&l.closeDeleteCategoryModal(...e))})]),(0,s.Lk)("div",_a,[(0,s.Lk)("div",Ja,[Va,(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":o[20]||(o[20]=e=>l.categoryToDelete=e),class:"form-control"},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.categories,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e,value:e},(0,i.v_)(e),9,Oa)))),128))],512),[[a.u1,l.categoryToDelete]])])]),(0,s.Lk)("div",Qa,[(0,s.Lk)("button",{type:"button",class:"btn btn-secondary",onClick:o[21]||(o[21]=(...e)=>l.closeDeleteCategoryModal&&l.closeDeleteCategoryModal(...e))},"Fermer"),(0,s.Lk)("button",{type:"button",class:"btn btn-danger",onClick:o[22]||(o[22]=(...e)=>l.deleteCategory&&l.deleteCategory(...e))},"Supprimer la catégorie")])])])],2)):(0,s.Q3)("",!0)])],64)}var Da={methods:{goBack(){this.$router.push("/admin-dashboard")}},setup(){const e=(0,Re.KR)({}),o=(0,Re.KR)(""),t=(0,Ie.C3)(),a=(0,P.rd)(),l=(0,E.Pj)(),n=(0,Re.KR)(""),r=(0,E.Pj)(),i=(0,Re.KR)(!1),c=(0,Re.KR)({}),d=(0,Re.KR)(!1),u=(0,Re.KR)({}),m=(0,Re.KR)(!1),p=(0,Re.KR)(""),b=(0,Re.KR)(!1),k=(0,Re.KR)(!1),v=(0,Re.KR)(""),g=()=>{v.value="",k.value=!0},L=()=>{k.value=!1},h=async()=>{const e=(0,Ie.KR)(t,`products/${v.value}`),o=await(0,Ie.Jt)(e),a=o.val();for(const s in a){const e=(0,Ie.KR)(t,`products/${v.value}/${s}`);await(0,Ie.TF)(e).catch((e=>{console.error(`Échec de la suppression du produit : ${s} dans la catégorie : ${v.value}`,e)}))}await(0,Ie.TF)(e).catch((e=>{console.error(`Échec de la suppression de la catégorie : ${v.value}`,e)})),L()},y=()=>{"new"===u.value.category?(b.value=!0,u.value.category=""):b.value=!1},f=()=>{u.value={},d.value=!0},C=()=>{d.value=!1},w=async()=>{b.value&&(u.value.category=p.value);const e=(0,Ie.KR)(t,`products/${u.value.category}/${u.value.name}`);await(0,Ie.hZ)(e,{name:u.value.name,price:u.value.price,image:u.value.image}).catch((e=>{console.error(`Échec de l'ajout du produit : ${u.value.name} dans la catégorie : ${u.value.category}`,e)})),C()},A=()=>{p.value="",m.value=!0},M=()=>{m.value=!1},U=async()=>{const e=(0,Ie.KR)(t,`products/${p.value}`),o={name:p.value,products:{}};await(0,Ie.hZ)(e,o).catch((e=>{console.error(`Échec de l'ajout de la catégorie : ${p.value}`,e)})),M()};(0,s.sV)((async()=>{if(l.state.admin){const o=(0,Ie.KR)(t,"products");(0,Ie.Zy)(o,(o=>{e.value=o.val()}))}else a.push("/")}));const K=e=>{c.value={...e},i.value=!0},x=()=>{i.value=!1},R=async()=>{const e=(0,Ie.KR)(t,`products/${c.value.category}/${c.value.name}`);await(0,Ie.yo)(e,{name:c.value.name,price:c.value.price,image:c.value.image}).catch((e=>{console.error(`Échec de la modification du produit : ${c.value.name} dans la catégorie : ${c.value.category}`,e)})),x()},I=async(e,o)=>{if(o&&e.name){const a=(0,Ie.KR)(t,`products/${o}`),s=await(0,Ie.Jt)(a),l=s.val();if(1===Object.keys(l).length)return void r.dispatch("showNotification",{message:`Échec de la suppression du produit : ${e.name} est le dernier produit de la catégorie : ${o}. Vous ne pouvez pas supprimer le dernier produit d'une catégorie.`,type:"error"});const n=(0,Ie.KR)(t,`products/${o}/${e.name}`);await(0,Ie.TF)(n).catch((t=>{console.error(`Échec de la suppression du produit : ${e.name} dans la catégorie : ${o}`,t)}))}else console.error(`Échec de la suppression du produit : La catégorie ou le nom du produit n'est pas défini. Catégorie : ${o}, Nom du produit : ${e.name}`)},j=(0,s.EW)((()=>Object.keys(e.value))),$=(0,s.EW)((()=>{let t=[];if(e.value){for(const o in e.value){const a=Object.values(e.value[o]);for(const e of a)e.category=o,t.push(e)}o.value&&(t=t.filter((e=>e.category===o.value))),n.value&&(t=t.filter((e=>e.name.includes(n.value))))}return t}));return{products:e,editProduct:R,deleteProduct:I,categories:j,selectedCategory:o,filteredProducts:$,searchTerm:n,isEditModalOpen:i,editedProduct:c,openEditModal:K,closeEditModal:x,isAddProductModalOpen:d,newProduct:u,openAddProductModal:f,closeAddProductModal:C,addProduct:w,isAddCategoryModalOpen:m,newCategory:p,openAddCategoryModal:A,closeAddCategoryModal:M,addCategory:U,isNewCategory:b,handleCategoryChange:y,isDeleteCategoryModalOpen:k,categoryToDelete:v,openDeleteCategoryModal:g,closeDeleteCategoryModal:L,deleteCategory:h}}};const Wa=(0,V.A)(Da,[["render",Sa],["__scopeId","data-v-31679dfc"]]);var Ba=Wa;const qa=[{path:"/admin-dashboard",name:"AdminDashboard",component:Qo,meta:{requiresAdmin:!0}},{path:"/",name:"Home",component:_e},{path:"/login",name:"Login",component:oo},{path:"/register",name:"Register",component:yo},{path:"/admin-dashboard",name:"AdminDashboard",component:Qo},{path:"/:pathMatch(.*)*",name:"NotFound",component:Ro},{path:"/admin-dashboard",name:"AdminDashboard",component:Qo,meta:{requiresAdmin:!0}},{path:"/user-management",name:"UserManagement",component:Dt,meta:{requiresAdmin:!0}},{path:"/product-management",name:"ProductManagement",component:Ba,meta:{requiresAdmin:!0}},{path:"/:pathMatch(.*)*",name:"NotFound",component:Ro}],za=(0,P.aE)({history:(0,P.LA)("/vuejs-projet-web/"),routes:qa});za.beforeEach(((e,o,t)=>{e.matched.some((e=>e.meta.requiresAdmin))?Do.state.admin?t():t({name:"Home"}):("Login"===e.name||"Register"===e.name)&&Do.state.isLoggedIn?t({name:"Home"}):t()}));var Ga=za,Za={data(){return{logoUrl:t(4912)}},setup(){const e=(0,E.Pj)(),o=(0,s.EW)((()=>e.state.isLoggedIn)),t=(0,s.EW)((()=>e.state.user?e.state.user.username:"")),a=(0,s.EW)((()=>e.state.admin)),l=()=>{e.dispatch("logout"),e.commit("logout"),Ga.push("/"),e.dispatch("showNotification",{message:"Deconnexion réussie",type:"success"})};return{username:t,isLoggedIn:o,logout:l,isAdmin:a}}};const Ha=(0,V.A)(Za,[["render",A],["__scopeId","data-v-1f5c9874"]]);var Ya=Ha;function es(e,o,t,a,l,n){return t.message?((0,s.uX)(),(0,s.CE)("div",{key:0,class:(0,i.C4)(`notification ${t.type}`)},(0,i.v_)(t.message),3)):(0,s.Q3)("",!0)}var os={props:{message:{type:String,default:""},type:{type:String,default:"info"}}};const ts=(0,V.A)(os,[["render",es],["__scopeId","data-v-67915a9c"]]);var as=ts,ss={components:{AppNavbar:Ya,NotificationApp:as},setup(){const e=(0,E.Pj)(),o=(0,s.EW)((()=>e.state.notification));return{notification:o}},data(){return{pageTitre:"Accueil"}},mounted(){document.title=this.pageTitre}};const ls=(0,V.A)(ss,[["render",r]]);var ns=ls,rs=t(6400);const is={apiKey:"AIzaSyAJRp8WxcFUDzBzsRnqG-TZTUQG3jWGjnQ",authDomain:"vuejs-ae8a0.firebaseapp.com",databaseURL:"https://vuejs-ae8a0-default-rtdb.europe-west1.firebasedatabase.app",projectId:"vuejs-ae8a0",storageBucket:"vuejs-ae8a0.appspot.com",messagingSenderId:"104652181195",appId:"1:104652181195:web:9bba7498e6fb88baa7d54e",measurementId:"G-2CJPHT3X6K"};(0,rs.Wp)(is),Do.dispatch("init").then((()=>{const e=(0,a.Ef)(ns);e.use(Do),e.use(Ga),e.mount("#app")})).catch((e=>{console.error("Failed to init store: ",e)}))},4912:function(e,o,t){e.exports=t.p+"img/LogoToboo.f339544e.png"}},o={};function t(a){var s=o[a];if(void 0!==s)return s.exports;var l=o[a]={id:a,loaded:!1,exports:{}};return e[a].call(l.exports,l,l.exports,t),l.loaded=!0,l.exports}t.m=e,function(){var e=[];t.O=function(o,a,s,l){if(!a){var n=1/0;for(d=0;d<e.length;d++){a=e[d][0],s=e[d][1],l=e[d][2];for(var r=!0,i=0;i<a.length;i++)(!1&l||n>=l)&&Object.keys(t.O).every((function(e){return t.O[e](a[i])}))?a.splice(i--,1):(r=!1,l<n&&(n=l));if(r){e.splice(d--,1);var c=s();void 0!==c&&(o=c)}}return o}l=l||0;for(var d=e.length;d>0&&e[d-1][2]>l;d--)e[d]=e[d-1];e[d]=[a,s,l]}}(),function(){t.n=function(e){var o=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(o,{a:o}),o}}(),function(){t.d=function(e,o){for(var a in o)t.o(o,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:o[a]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)}}(),function(){t.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){t.p="/vuejs-projet-web/"}(),function(){var e={524:0};t.O.j=function(o){return 0===e[o]};var o=function(o,a){var s,l,n=a[0],r=a[1],i=a[2],c=0;if(n.some((function(o){return 0!==e[o]}))){for(s in r)t.o(r,s)&&(t.m[s]=r[s]);if(i)var d=i(t)}for(o&&o(a);c<n.length;c++)l=n[c],t.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return t.O(d)},a=self["webpackChunkprojet_web"]=self["webpackChunkprojet_web"]||[];a.forEach(o.bind(null,0)),a.push=o.bind(null,a.push.bind(a))}();var a=t.O(void 0,[504],(function(){return t(4124)}));a=t.O(a)})();
//# sourceMappingURL=app.2612ecd6.js.map